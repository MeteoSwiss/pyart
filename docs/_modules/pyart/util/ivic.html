
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>pyart.util.ivic &#8212; pyart-mch 0.4.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pyart-mch 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pyart.util.ivic</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">pyart.util.ivic</span>
<span class="sd">===============</span>

<span class="sd">Estimation of noise in a ray using Ivic (2013) method</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    estimate_noise_ivic13</span>
<span class="sd">    get_ivic_pct</span>
<span class="sd">    get_ivic_flat_reg_var_max</span>
<span class="sd">    get_ivic_snr_thr</span>
<span class="sd">    ivic_pct_table</span>
<span class="sd">    ivic_flat_reg_var_max_table</span>
<span class="sd">    ivic_snr_thr_table</span>


<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">gammainc</span><span class="p">,</span> <span class="n">gammaincc</span><span class="p">,</span> <span class="n">factorial</span>

<span class="kn">from</span> <span class="nn">.sigmath</span> <span class="kn">import</span> <span class="n">rolling_window</span>


<div class="viewcode-block" id="estimate_noise_ivic13"><a class="viewcode-back" href="../../../util.html#pyart.util.estimate_noise_ivic13">[docs]</a><span class="k">def</span> <span class="nf">estimate_noise_ivic13</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">,</span> <span class="n">pct</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">flat_reg_wlen</span><span class="o">=</span><span class="mi">96</span><span class="p">,</span>
                          <span class="n">flat_reg_var_max</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">snr_thr</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">npulses</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                          <span class="n">ngates_min</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">get_noise_pos</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate noise parameters of a ray</span>

<span class="sd">    Use the method of estimating the noise level in a ray outlined</span>
<span class="sd">    by Ivic, 2013.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pwr_w_ray : array like</span>
<span class="sd">        Doppler spectrum in linear units.</span>
<span class="sd">    pct : float</span>
<span class="sd">        Point Clutter Threshold</span>
<span class="sd">    delay : int</span>
<span class="sd">        distance of the gate to which compare for point target threshold</span>
<span class="sd">    flat_reg_wlen : int</span>
<span class="sd">        Minimum number of gates that should contain a valid region. Default</span>
<span class="sd">        gives a size of 8 km with 83.3 m resolution</span>
<span class="sd">    flat_reg_var_max : float</span>
<span class="sd">        Maximum local variance of powers in decibels to consider the region</span>
<span class="sd">        as flat.</span>
<span class="sd">    snr_thr : float</span>
<span class="sd">        Threshold applied in steps 3 and 6</span>
<span class="sd">    npulses : int</span>
<span class="sd">        Number of pulses used to compute the power of the array</span>
<span class="sd">    ngates_min: int</span>
<span class="sd">        minimum number of gates with noise to consider the retrieval valid</span>
<span class="sd">    iterations: int</span>
<span class="sd">        number of iterations in step 7</span>
<span class="sd">    get_noise_pos : bool</span>
<span class="sd">        If True the indices of the gates identified as noise will be returned</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mean : float-like</span>
<span class="sd">        Mean of the gates in the ray identified as noise.</span>
<span class="sd">    var : float-like</span>
<span class="sd">        Variance of the gates in the ray identified as noise.</span>
<span class="sd">    nnoise : int</span>
<span class="sd">        Number of noise gates in the ray.</span>
<span class="sd">    inds_ray : 1D-array</span>
<span class="sd">        The indices of the gates containing noise</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    I.R. Ivic, C. Curtis and S.M. Torres, Radial-Based Noise Power Estimation</span>
<span class="sd">    for Weather Radars. Journal of Atmospheric and Oceanic Technology, 2013,</span>
<span class="sd">    30, 2737-2753.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">half_flat_reg_wlen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">get_noise_pos</span><span class="p">:</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="c1"># step 1 remove gates with discontinuities in range</span>
    <span class="n">pwr_w_ray_aux</span> <span class="o">=</span> <span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">delay</span><span class="p">:</span><span class="o">-</span><span class="n">delay</span><span class="p">]</span>
    <span class="n">pwr_w_ray_aux</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">pwr_w_ray_aux</span><span class="p">,</span> <span class="n">pct</span><span class="o">*</span><span class="n">pwr_w_ray</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">delay</span><span class="p">]),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">greater</span><span class="p">(</span><span class="n">pwr_w_ray_aux</span><span class="p">,</span> <span class="n">pct</span><span class="o">*</span><span class="n">pwr_w_ray</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">delay</span><span class="p">:]))]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
    <span class="k">if</span> <span class="n">get_noise_pos</span><span class="p">:</span>
        <span class="n">inds_ray_aux</span> <span class="o">=</span> <span class="n">inds_ray</span><span class="p">[</span><span class="n">delay</span><span class="p">:</span><span class="o">-</span><span class="n">delay</span><span class="p">]</span>
        <span class="n">inds_ray_aux</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="n">pwr_w_ray_aux</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inds_ray_aux</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="n">pwr_w_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pwr_w_ray_aux</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="n">flat_reg_wlen</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="c1"># step 2 detect flat sections and estimate mean power of the grouped flat</span>
    <span class="c1"># sections. Take smallest power as intermediate power</span>

    <span class="c1"># compute moving variance (in dB)</span>
    <span class="n">pwr_dB_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">)</span>
    <span class="n">pwr_dB_wind</span> <span class="o">=</span> <span class="n">rolling_window</span><span class="p">(</span><span class="n">pwr_dB_ray</span><span class="p">,</span> <span class="n">flat_reg_wlen</span><span class="p">)</span>
    <span class="n">pwr_dB_wind_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pwr_dB_wind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="c1"># add third dimension made of mean values of the window</span>
    <span class="n">pwr_dB_wind_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">pwr_dB_wind_mean</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="n">pwr_dB_wind_mean</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">flat_reg_wlen</span><span class="p">))</span>
    <span class="n">pwr_dB_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="p">(</span><span class="n">pwr_dB_wind</span><span class="o">-</span><span class="n">pwr_dB_wind_mean</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pwr_dB_wind</span><span class="o">-</span><span class="n">pwr_dB_wind_mean</span><span class="p">),</span>
        <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># mask non-flat regions</span>
    <span class="n">pwr_w_ray</span> <span class="o">=</span> <span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">half_flat_reg_wlen</span><span class="p">:</span><span class="o">-</span><span class="n">half_flat_reg_wlen</span><span class="p">]</span>
    <span class="n">inds_non_flat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pwr_dB_var</span> <span class="o">&gt;</span> <span class="n">flat_reg_var_max</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">inds_non_flat</span><span class="p">:</span>
        <span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">ind</span><span class="o">-</span><span class="n">half_flat_reg_wlen</span><span class="p">:</span><span class="n">ind</span><span class="o">+</span><span class="n">half_flat_reg_wlen</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span><span class="p">)</span>

    <span class="c1"># group consecutive gates and get the minimum mean power</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span> <span class="o">==</span> <span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cons_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">pwr_w_int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">cons</span> <span class="ow">in</span> <span class="n">cons_list</span><span class="p">:</span>
        <span class="n">pwr_w_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">cons</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">pwr_w_int</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pwr_w_int</span> <span class="o">=</span> <span class="n">pwr_w_mean</span>
        <span class="k">elif</span> <span class="n">pwr_w_int</span> <span class="o">&gt;</span> <span class="n">pwr_w_mean</span><span class="p">:</span>
            <span class="n">pwr_w_int</span> <span class="o">=</span> <span class="n">pwr_w_mean</span>

    <span class="k">if</span> <span class="n">pwr_w_int</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">get_noise_pos</span><span class="p">:</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">inds_ray</span><span class="p">[</span><span class="n">half_flat_reg_wlen</span><span class="p">:</span><span class="o">-</span><span class="n">half_flat_reg_wlen</span><span class="p">]</span>
        <span class="n">inds_ray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inds_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="n">pwr_w_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>

    <span class="c1"># step 3 remove gates exceeding a threshold based on pwr_int</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pwr_w_ray</span> <span class="o">&gt;</span> <span class="n">pwr_w_int</span><span class="o">*</span><span class="n">snr_thr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
    <span class="k">if</span> <span class="n">get_noise_pos</span><span class="p">:</span>
        <span class="n">inds_ray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inds_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="n">pwr_w_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="c1"># step 4 &amp; 5: detect 10 or more consecutive gates with power larger than</span>
    <span class="c1"># the median. Compute the mean of the remaining data</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pwr_w_ray</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">cons_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cons</span> <span class="ow">in</span> <span class="n">cons_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">cons</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
    <span class="k">if</span> <span class="n">get_noise_pos</span><span class="p">:</span>
        <span class="n">inds_ray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inds_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="n">pwr_w_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="n">pwr_w_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">)</span>

    <span class="c1"># step 6: same as test 3 but with pwr_w_mean</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pwr_w_ray</span> <span class="o">&gt;</span> <span class="n">pwr_w_mean</span><span class="o">*</span><span class="n">snr_thr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
    <span class="k">if</span> <span class="n">get_noise_pos</span><span class="p">:</span>
        <span class="n">inds_ray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inds_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="n">pwr_w_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="c1"># step 7: running sum</span>
    <span class="n">rs_wlen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="n">npulses</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">rs_wlen</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rs_wlen</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">half_rs_wlen</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">rs_wlen</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">gammaincc</span><span class="p">(</span><span class="n">rs_wlen</span><span class="o">*</span><span class="n">npulses</span><span class="p">,</span> <span class="mf">1.12</span><span class="o">*</span><span class="n">rs_wlen</span><span class="o">*</span><span class="n">npulses</span><span class="p">)</span>

    <span class="n">valid_noise</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="c1"># check if there are sufficient noisy gates left</span>
        <span class="k">if</span> <span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">()</span><span class="o">.</span><span class="n">size</span><span class="o">*</span><span class="n">npulses</span> <span class="o">&lt;</span> <span class="n">ngates_min</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="c1"># compute running sum</span>
        <span class="n">pwr_mw_wind</span> <span class="o">=</span> <span class="n">rolling_window</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">,</span> <span class="n">rs_wlen</span><span class="p">)</span>
        <span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pwr_mw_wind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pwr_w_ray</span> <span class="o">=</span> <span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">half_rs_wlen</span><span class="p">:</span><span class="o">-</span><span class="n">half_rs_wlen</span><span class="p">]</span>

        <span class="c1"># check if sums exceeding threshold are below the criteria</span>
        <span class="n">inds_excess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rs</span> <span class="o">&gt;</span> <span class="mf">1.12</span><span class="o">*</span><span class="n">rs_wlen</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">inds_excess</span><span class="o">.</span><span class="n">size</span><span class="o">/</span><span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;=</span> <span class="n">criterion</span><span class="p">:</span>
            <span class="c1"># The ratio of invalid running sums is below the criterion</span>
            <span class="n">valid_noise</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>

        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="n">inds_excess</span><span class="p">:</span>
            <span class="n">pwr_w_ray</span><span class="p">[</span><span class="n">ind</span><span class="o">-</span><span class="n">half_rs_wlen</span><span class="p">:</span><span class="n">ind</span><span class="o">+</span><span class="n">half_rs_wlen</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
        <span class="k">if</span> <span class="n">get_noise_pos</span><span class="p">:</span>
            <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">inds_ray</span><span class="p">[</span><span class="n">half_rs_wlen</span><span class="p">:</span><span class="o">-</span><span class="n">half_rs_wlen</span><span class="p">]</span>
            <span class="n">inds_ray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmaskarray</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked</span>
            <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">inds_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
        <span class="n">pwr_w_ray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">())</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_noise</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">get_noise_pos</span><span class="p">:</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="n">inds_ray</span><span class="o">.</span><span class="n">compressed</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inds_ray</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">pwr_w_ray</span><span class="p">),</span> <span class="n">pwr_w_ray</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">inds_ray</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_ivic_pct"><a class="viewcode-back" href="../../../util.html#pyart.util.get_ivic_pct">[docs]</a><span class="k">def</span> <span class="nf">get_ivic_pct</span><span class="p">(</span><span class="n">npulses</span><span class="p">,</span> <span class="n">pct</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">prob_thr</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the point clutter threshold (PCT)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npulses : 1D array</span>
<span class="sd">        array with the number of pulses in a ray</span>
<span class="sd">    pct : 1D array</span>
<span class="sd">        array with possible values of the PCT</span>
<span class="sd">    z : 1D array</span>
<span class="sd">        array of z values</span>
<span class="sd">    prob_thr : float</span>
<span class="sd">        Desired probability</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pct_out : 1D array</span>
<span class="sd">        The PCT threshold corresponding to each number of pulses</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">delta_z</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pct_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">npulses</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">npuls</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">npulses</span><span class="p">):</span>
        <span class="n">prob_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pct</span><span class="p">))</span>
        <span class="n">fact</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">npuls</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">func_part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">npuls</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">pct_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pct</span><span class="p">):</span>
            <span class="n">gamma_inc</span> <span class="o">=</span> <span class="n">gammainc</span><span class="p">(</span><span class="n">npuls</span><span class="p">,</span> <span class="n">z</span><span class="o">/</span><span class="n">pct_val</span><span class="p">)</span>
            <span class="n">prob_func</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">fact</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
                <span class="n">func_part</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">gamma_inc</span><span class="o">-</span><span class="n">gamma_inc</span><span class="o">*</span><span class="n">gamma_inc</span><span class="p">))</span><span class="o">*</span><span class="n">delta_z</span>
        <span class="n">delta_prob_func</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prob_thr</span><span class="o">-</span><span class="n">prob_func</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">delta_prob_func</span><span class="p">)</span>
        <span class="n">pct_out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pct</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">pct_out</span></div>


<div class="viewcode-block" id="get_ivic_flat_reg_var_max"><a class="viewcode-back" href="../../../util.html#pyart.util.get_ivic_flat_reg_var_max">[docs]</a><span class="k">def</span> <span class="nf">get_ivic_flat_reg_var_max</span><span class="p">(</span><span class="n">npulses</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">flat_reg_wlen</span><span class="p">,</span> <span class="n">ndBm</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span>
                              <span class="n">accuracy</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the threshold for maximum local variance of noise [dB]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npulses : 1D array</span>
<span class="sd">        array with the number of pulses in a ray</span>
<span class="sd">    y : 1D array</span>
<span class="sd">        array of y values</span>
<span class="sd">    x : 1D array</span>
<span class="sd">        array of x values. These are the possible values of the threshold</span>
<span class="sd">    flat_reg_wlen : int</span>
<span class="sd">        the lenght of the flat region window in bins</span>
<span class="sd">    ndBm : float</span>
<span class="sd">        the mean noise power in dBm</span>
<span class="sd">    accuracy : float</span>
<span class="sd">        The desired accuracy of the threshold (difference with target</span>
<span class="sd">        probability)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    var_thr : 1D array</span>
<span class="sd">        The thresholds corresponding to each number of pulses</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">delta_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">delta_x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">wconst1</span> <span class="o">=</span> <span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">wconst2</span> <span class="o">=</span> <span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">flat_reg_wlen</span>
    <span class="n">wconst3</span> <span class="o">=</span> <span class="n">flat_reg_wlen</span><span class="o">*</span><span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">flat_reg_wlen</span><span class="o">+</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="n">flat_reg_wlen</span>
    <span class="n">wconst4</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">flat_reg_wlen</span><span class="o">*</span><span class="n">flat_reg_wlen</span><span class="o">*</span><span class="n">flat_reg_wlen</span> <span class="o">+</span>
         <span class="mi">12</span><span class="o">*</span><span class="n">flat_reg_wlen</span><span class="o">*</span><span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">22</span><span class="o">*</span><span class="n">flat_reg_wlen</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span><span class="o">/</span><span class="n">flat_reg_wlen</span><span class="p">)</span>
    <span class="n">wconst5</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">flat_reg_wlen</span><span class="p">)</span>
    <span class="n">wconst6</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">flat_reg_wlen</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="n">flat_reg_wlen</span><span class="p">)</span>

    <span class="n">var_thr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">npulses</span><span class="p">))</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">ndBm</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">npuls</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">npulses</span><span class="p">):</span>
        <span class="n">pdb_const</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">npuls</span><span class="p">,</span> <span class="n">npuls</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span> <span class="o">/</span>
            <span class="p">(</span><span class="mf">10.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">npuls</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">npuls</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">pdb_part2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">npuls</span><span class="o">/</span><span class="n">n</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">y</span><span class="o">/</span><span class="mf">10.</span><span class="p">))</span>
        <span class="n">pdb_part1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">npuls</span><span class="o">/</span><span class="mf">10.</span><span class="p">)</span>

        <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span>
        <span class="n">y3</span> <span class="o">=</span> <span class="n">y2</span><span class="o">*</span><span class="n">y</span>
        <span class="n">y4</span> <span class="o">=</span> <span class="n">y3</span><span class="o">*</span><span class="n">y</span>

        <span class="n">pdb_1</span> <span class="o">=</span> <span class="n">pdb_const</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">pdb_part1</span><span class="o">*</span><span class="n">pdb_part2</span><span class="p">)</span><span class="o">*</span><span class="n">delta_y</span>
        <span class="n">pdb_2</span> <span class="o">=</span> <span class="n">pdb_const</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y2</span><span class="o">*</span><span class="n">pdb_part1</span><span class="o">*</span><span class="n">pdb_part2</span><span class="p">)</span><span class="o">*</span><span class="n">delta_y</span>
        <span class="n">pdb_3</span> <span class="o">=</span> <span class="n">pdb_const</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y3</span><span class="o">*</span><span class="n">pdb_part1</span><span class="o">*</span><span class="n">pdb_part2</span><span class="p">)</span><span class="o">*</span><span class="n">delta_y</span>
        <span class="n">pdb_4</span> <span class="o">=</span> <span class="n">pdb_const</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y4</span><span class="o">*</span><span class="n">pdb_part1</span><span class="o">*</span><span class="n">pdb_part2</span><span class="p">)</span><span class="o">*</span><span class="n">delta_y</span>

        <span class="n">pdb_1_2</span> <span class="o">=</span> <span class="n">pdb_1</span><span class="o">*</span><span class="n">pdb_1</span>

        <span class="n">vardb_1</span> <span class="o">=</span> <span class="n">wconst1</span><span class="o">*</span><span class="p">(</span><span class="n">pdb_2</span><span class="o">-</span><span class="n">pdb_1_2</span><span class="p">)</span>
        <span class="n">vardb_2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pdb_4</span><span class="o">*</span><span class="n">wconst2</span><span class="o">+</span><span class="n">pdb_2</span><span class="o">*</span><span class="n">pdb_2</span><span class="o">*</span><span class="n">wconst3</span><span class="o">+</span><span class="n">pdb_2</span><span class="o">*</span><span class="n">pdb_1_2</span><span class="o">*</span><span class="n">wconst4</span> <span class="o">+</span>
            <span class="n">pdb_1</span><span class="o">*</span><span class="n">pdb_3</span><span class="o">*</span><span class="n">wconst5</span><span class="o">+</span><span class="n">wconst6</span><span class="o">*</span><span class="n">pdb_1_2</span><span class="o">*</span><span class="n">pdb_1_2</span><span class="p">)</span>

        <span class="n">vardb_1_2</span> <span class="o">=</span> <span class="n">vardb_1</span><span class="o">*</span><span class="n">vardb_1</span>

        <span class="n">alpha</span> <span class="o">=</span> <span class="n">vardb_1_2</span><span class="o">/</span><span class="p">(</span><span class="n">vardb_2</span><span class="o">-</span><span class="n">vardb_1_2</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">vardb_2</span><span class="o">-</span><span class="n">vardb_1_2</span><span class="p">)</span><span class="o">/</span><span class="n">vardb_1</span>

        <span class="n">pdf</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="n">theta</span><span class="p">)</span> <span class="o">/</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">gamma</span><span class="p">(</span><span class="n">alpha</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>
            <span class="n">prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pdf</span><span class="p">[</span><span class="n">ind</span><span class="p">:])</span><span class="o">*</span><span class="n">delta_x</span>
            <span class="n">delta_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prob</span><span class="o">-</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="c1"># print(&#39;delta_prob: &#39;, delta_prob, &#39; threshold: &#39;, x[ind])</span>
            <span class="k">if</span> <span class="n">delta_prob</span> <span class="o">&lt;</span> <span class="n">accuracy</span><span class="p">:</span>
                <span class="n">var_thr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">var_thr</span></div>


<div class="viewcode-block" id="get_ivic_snr_thr"><a class="viewcode-back" href="../../../util.html#pyart.util.get_ivic_snr_thr">[docs]</a><span class="k">def</span> <span class="nf">get_ivic_snr_thr</span><span class="p">(</span><span class="n">npulses</span><span class="p">,</span> <span class="n">snr_thr</span><span class="p">,</span> <span class="n">pfa_thr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the threshold for steps 3 and 6 of ivic</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npulses : 1D array</span>
<span class="sd">        array with the number of pulses in a ray</span>
<span class="sd">    snr_thr : 1D array</span>
<span class="sd">        array with possible values of the snr threshold</span>
<span class="sd">    pfa_thr : float</span>
<span class="sd">        the desired probability of false alarm</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    snr_thr_out : 1D array</span>
<span class="sd">        The snr threshold corresponding to each number of pulses according to</span>
<span class="sd">        the desired probability of false alarm</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">snr_thr_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">npulses</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">npuls</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">npulses</span><span class="p">):</span>
        <span class="n">pfa</span> <span class="o">=</span> <span class="n">gammaincc</span><span class="p">(</span><span class="n">npuls</span><span class="p">,</span> <span class="n">snr_thr</span><span class="o">*</span><span class="n">npuls</span><span class="p">)</span>
        <span class="n">delta_pfa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">pfa</span><span class="o">-</span><span class="n">pfa_thr</span><span class="p">)</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">delta_pfa</span><span class="p">)</span>
        <span class="n">snr_thr_out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">snr_thr</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">snr_thr_out</span></div>


<div class="viewcode-block" id="ivic_pct_table"><a class="viewcode-back" href="../../../util.html#pyart.util.ivic_pct_table">[docs]</a><span class="k">def</span> <span class="nf">ivic_pct_table</span><span class="p">(</span><span class="n">npulses</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the point clutter threshold (PCT) of Ivic from a look up table.</span>
<span class="sd">    The thresholds are computed for between 3 and 78 pulses. If there</span>
<span class="sd">    number of pulses is beyond this range it throws an error</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npulses : 1D array</span>
<span class="sd">        array with the number of pulses in a ray</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pct_table : 1D array</span>
<span class="sd">        The PCT corresponding to each number of pulses</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">npulses</span> <span class="o">&gt;</span> <span class="mi">78</span><span class="p">,</span> <span class="n">npulses</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table valid for number of pulses between 3 and 78&quot;</span><span class="p">)</span>

    <span class="n">ind_npulses</span> <span class="o">=</span> <span class="p">(</span><span class="n">npulses</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>

    <span class="n">pct_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="mf">56.97</span><span class="p">,</span> <span class="mf">27.31</span><span class="p">,</span> <span class="mf">17.37</span><span class="p">,</span> <span class="mf">12.73</span><span class="p">,</span> <span class="mf">10.12</span><span class="p">,</span> <span class="mf">8.47</span><span class="p">,</span> <span class="mf">7.34</span><span class="p">,</span> <span class="mf">6.53</span><span class="p">,</span> <span class="mf">5.91</span><span class="p">,</span> <span class="mf">5.43</span><span class="p">,</span> <span class="mf">5.04</span><span class="p">,</span>
        <span class="mf">4.72</span><span class="p">,</span> <span class="mf">4.45</span><span class="p">,</span> <span class="mf">4.23</span><span class="p">,</span> <span class="mf">4.03</span><span class="p">,</span> <span class="mf">3.87</span><span class="p">,</span> <span class="mf">3.72</span><span class="p">,</span> <span class="mf">3.59</span><span class="p">,</span> <span class="mf">3.74</span><span class="p">,</span> <span class="mf">3.37</span><span class="p">,</span> <span class="mf">3.27</span><span class="p">,</span> <span class="mf">3.19</span><span class="p">,</span>
        <span class="mf">3.11</span><span class="p">,</span> <span class="mf">3.04</span><span class="p">,</span> <span class="mf">2.97</span><span class="p">,</span> <span class="mf">2.91</span><span class="p">,</span> <span class="mf">2.85</span><span class="p">,</span> <span class="mf">2.80</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">,</span> <span class="mf">2.71</span><span class="p">,</span> <span class="mf">2.66</span><span class="p">,</span> <span class="mf">2.62</span><span class="p">,</span> <span class="mf">2.59</span><span class="p">,</span>
        <span class="mf">2.55</span><span class="p">,</span> <span class="mf">2.52</span><span class="p">,</span> <span class="mf">2.49</span><span class="p">,</span> <span class="mf">2.46</span><span class="p">,</span> <span class="mf">2.43</span><span class="p">,</span> <span class="mf">2.40</span><span class="p">,</span> <span class="mf">2.37</span><span class="p">,</span> <span class="mf">2.35</span><span class="p">,</span> <span class="mf">2.33</span><span class="p">,</span> <span class="mf">2.30</span><span class="p">,</span> <span class="mf">2.28</span><span class="p">,</span>
        <span class="mf">2.26</span><span class="p">,</span> <span class="mf">2.24</span><span class="p">,</span> <span class="mf">2.22</span><span class="p">,</span> <span class="mf">2.20</span><span class="p">,</span> <span class="mf">2.19</span><span class="p">,</span> <span class="mf">2.17</span><span class="p">,</span> <span class="mf">2.15</span><span class="p">,</span> <span class="mf">2.14</span><span class="p">,</span> <span class="mf">2.12</span><span class="p">,</span> <span class="mf">2.11</span><span class="p">,</span> <span class="mf">2.09</span><span class="p">,</span>
        <span class="mf">2.08</span><span class="p">,</span> <span class="mf">2.07</span><span class="p">,</span> <span class="mf">2.05</span><span class="p">,</span> <span class="mf">2.04</span><span class="p">,</span> <span class="mf">2.03</span><span class="p">,</span> <span class="mf">2.02</span><span class="p">,</span> <span class="mf">2.01</span><span class="p">,</span> <span class="mf">1.99</span><span class="p">,</span> <span class="mf">1.98</span><span class="p">,</span> <span class="mf">1.97</span><span class="p">,</span> <span class="mf">1.96</span><span class="p">,</span>
        <span class="mf">1.95</span><span class="p">,</span> <span class="mf">1.94</span><span class="p">,</span> <span class="mf">1.93</span><span class="p">,</span> <span class="mf">1.93</span><span class="p">,</span> <span class="mf">1.92</span><span class="p">,</span> <span class="mf">1.91</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">,</span> <span class="mf">1.89</span><span class="p">,</span> <span class="mf">1.88</span><span class="p">,</span> <span class="mf">1.88</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">pct_table</span><span class="p">[</span><span class="n">ind_npulses</span><span class="p">]</span></div>


<div class="viewcode-block" id="ivic_flat_reg_var_max_table"><a class="viewcode-back" href="../../../util.html#pyart.util.ivic_flat_reg_var_max_table">[docs]</a><span class="k">def</span> <span class="nf">ivic_flat_reg_var_max_table</span><span class="p">(</span><span class="n">npulses</span><span class="p">,</span> <span class="n">flat_reg_wlen</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get maximum variance of noise of Ivic from a look up table.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npulses : 1D array</span>
<span class="sd">        array with the number of pulses in a ray</span>
<span class="sd">    flat_reg_wlen : float</span>
<span class="sd">        The flat region window length in bins</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    flat_reg_var_max : 1D array</span>
<span class="sd">        The maximum variance threshold corresponding to each number of pulses</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flat_reg_var_max</span> <span class="o">=</span> <span class="mf">0.99</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">flat_reg_wlen</span><span class="p">)</span><span class="o">-</span><span class="mf">2.49</span>
    <span class="n">flat_reg_var_max</span> <span class="o">=</span> <span class="n">npulses</span><span class="o">/</span><span class="mi">15</span><span class="o">*</span><span class="n">flat_reg_var_max</span>

    <span class="k">return</span> <span class="n">flat_reg_var_max</span></div>


<div class="viewcode-block" id="ivic_snr_thr_table"><a class="viewcode-back" href="../../../util.html#pyart.util.ivic_snr_thr_table">[docs]</a><span class="k">def</span> <span class="nf">ivic_snr_thr_table</span><span class="p">(</span><span class="n">npulses</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the threshold for steps 3 and 6 of ivic from a look up table</span>
<span class="sd">    The thresholds are computed for between 3 and 200 pulses. If there</span>
<span class="sd">    number of pulses is beyond this range it throws an error</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    npulses : 1D array</span>
<span class="sd">        array with the number of pulses in a ray</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    snr_thr_out : 1D array</span>
<span class="sd">        The snr threshold corresponding to each number of pulses according to</span>
<span class="sd">        the desired probability of false alarm</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">npulses</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">,</span> <span class="n">npulses</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ind</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table valid for number of pulses between 3 and 200&quot;</span><span class="p">)</span>

    <span class="n">ind_npulses</span> <span class="o">=</span> <span class="p">(</span><span class="n">npulses</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>

    <span class="n">snr_thr_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="mf">3.74</span><span class="p">,</span> <span class="mf">3.27</span><span class="p">,</span> <span class="mf">2.96</span><span class="p">,</span> <span class="mf">2.74</span><span class="p">,</span> <span class="mf">2.58</span><span class="p">,</span> <span class="mf">2.45</span><span class="p">,</span> <span class="mf">2.35</span><span class="p">,</span> <span class="mf">2.27</span><span class="p">,</span> <span class="mf">2.19</span><span class="p">,</span> <span class="mf">2.13</span><span class="p">,</span> <span class="mf">2.08</span><span class="p">,</span>
        <span class="mf">2.03</span><span class="p">,</span> <span class="mf">1.99</span><span class="p">,</span> <span class="mf">1.95</span><span class="p">,</span> <span class="mf">1.92</span><span class="p">,</span> <span class="mf">1.89</span><span class="p">,</span> <span class="mf">1.86</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">,</span> <span class="mf">1.81</span><span class="p">,</span> <span class="mf">1.79</span><span class="p">,</span> <span class="mf">1.77</span><span class="p">,</span> <span class="mf">1.75</span><span class="p">,</span>
        <span class="mf">1.73</span><span class="p">,</span> <span class="mf">1.72</span><span class="p">,</span> <span class="mf">1.70</span><span class="p">,</span> <span class="mf">1.69</span><span class="p">,</span> <span class="mf">1.67</span><span class="p">,</span> <span class="mf">1.66</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">,</span> <span class="mf">1.64</span><span class="p">,</span> <span class="mf">1.63</span><span class="p">,</span> <span class="mf">1.61</span><span class="p">,</span> <span class="mf">1.60</span><span class="p">,</span>
        <span class="mf">1.60</span><span class="p">,</span> <span class="mf">1.59</span><span class="p">,</span> <span class="mf">1.58</span><span class="p">,</span> <span class="mf">1.57</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">1.55</span><span class="p">,</span> <span class="mf">1.54</span><span class="p">,</span> <span class="mf">1.53</span><span class="p">,</span> <span class="mf">1.52</span><span class="p">,</span> <span class="mf">1.52</span><span class="p">,</span>
        <span class="mf">1.51</span><span class="p">,</span> <span class="mf">1.51</span><span class="p">,</span> <span class="mf">1.50</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="mf">1.49</span><span class="p">,</span> <span class="mf">1.48</span><span class="p">,</span> <span class="mf">1.48</span><span class="p">,</span> <span class="mf">1.47</span><span class="p">,</span> <span class="mf">1.47</span><span class="p">,</span> <span class="mf">1.46</span><span class="p">,</span> <span class="mf">1.46</span><span class="p">,</span>
        <span class="mf">1.46</span><span class="p">,</span> <span class="mf">1.45</span><span class="p">,</span> <span class="mf">1.45</span><span class="p">,</span> <span class="mf">1.44</span><span class="p">,</span> <span class="mf">1.44</span><span class="p">,</span> <span class="mf">1.44</span><span class="p">,</span> <span class="mf">1.43</span><span class="p">,</span> <span class="mf">1.43</span><span class="p">,</span> <span class="mf">1.42</span><span class="p">,</span> <span class="mf">1.42</span><span class="p">,</span> <span class="mf">1.42</span><span class="p">,</span>
        <span class="mf">1.41</span><span class="p">,</span> <span class="mf">1.41</span><span class="p">,</span> <span class="mf">1.41</span><span class="p">,</span> <span class="mf">1.40</span><span class="p">,</span> <span class="mf">1.40</span><span class="p">,</span> <span class="mf">1.40</span><span class="p">,</span> <span class="mf">1.40</span><span class="p">,</span> <span class="mf">1.39</span><span class="p">,</span> <span class="mf">1.39</span><span class="p">,</span> <span class="mf">1.39</span><span class="p">,</span> <span class="mf">1.38</span><span class="p">,</span>
        <span class="mf">1.38</span><span class="p">,</span> <span class="mf">1.38</span><span class="p">,</span> <span class="mf">1.38</span><span class="p">,</span> <span class="mf">1.37</span><span class="p">,</span> <span class="mf">1.37</span><span class="p">,</span> <span class="mf">1.37</span><span class="p">,</span> <span class="mf">1.37</span><span class="p">,</span> <span class="mf">1.36</span><span class="p">,</span> <span class="mf">1.36</span><span class="p">,</span> <span class="mf">1.36</span><span class="p">,</span> <span class="mf">1.36</span><span class="p">,</span>
        <span class="mf">1.36</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span> <span class="mf">1.34</span><span class="p">,</span>
        <span class="mf">1.33</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">,</span> <span class="mf">1.33</span><span class="p">,</span> <span class="mf">1.32</span><span class="p">,</span> <span class="mf">1.32</span><span class="p">,</span> <span class="mf">1.32</span><span class="p">,</span> <span class="mf">1.32</span><span class="p">,</span> <span class="mf">1.32</span><span class="p">,</span>
        <span class="mf">1.32</span><span class="p">,</span> <span class="mf">1.31</span><span class="p">,</span> <span class="mf">1.31</span><span class="p">,</span> <span class="mf">1.31</span><span class="p">,</span> <span class="mf">1.31</span><span class="p">,</span> <span class="mf">1.31</span><span class="p">,</span> <span class="mf">1.31</span><span class="p">,</span> <span class="mf">1.31</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span>
        <span class="mf">1.30</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span> <span class="mf">1.30</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span>
        <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.29</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.28</span><span class="p">,</span>
        <span class="mf">1.28</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.27</span><span class="p">,</span>
        <span class="mf">1.27</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span>
        <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span>
        <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span>
        <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.24</span><span class="p">,</span> <span class="mf">1.23</span><span class="p">,</span> <span class="mf">1.23</span><span class="p">,</span> <span class="mf">1.23</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">snr_thr_table</span><span class="p">[</span><span class="n">ind_npulses</span><span class="p">]</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">pyart-mch 0.4.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, meteoswiss-mdr.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>